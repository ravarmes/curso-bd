<!doctype html>
<html lang="pt-br">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2.4 ‚Äî Construindo o MER no brModelo</title>
  <style>
    :root {
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #1f4f8b;
      --ok: #16a34a;
      --bad: #dc2626;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Arial, sans-serif;
      color: var(--text);
    }

    .wrap {
      padding: 14px 16px;
      max-width: 980px;
      margin: 0 auto;
    }

    h1 {
      font-size: 1.2rem;
      margin: 0 0 12px;
    }

    .tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .tab {
      border: 1px solid #d1d5db;
      background: #fff;
      border-radius: 10px;
      padding: 8px 12px;
      cursor: pointer;
    }

    .tab.active {
      background: #eef2ff;
      border-color: #6366f1;
    }

    .panel {
      display: none;
      margin-top: 12px;
    }

    .panel.active {
      display: block;
    }

    .note {
      color: var(--muted);
      font-size: 0.92rem;
    }

    .box {
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      background: #fafafa;
      padding: 12px;
    }

    .controls {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .list {
      margin: 0 0 8px;
      padding-left: 18px;
    }

    .checklist {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .checklist li {
      padding: 6px 0;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .checklist input[type="checkbox"] {
      width: 18px;
      height: 18px;
    }

    .checklist .done {
      text-decoration: line-through;
      color: var(--muted);
    }

    .progress-bar {
      height: 20px;
      background: #e5e7eb;
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #6366f1, #8b5cf6);
      transition: width 0.3s;
    }

    .progress-text {
      text-align: center;
      font-size: 0.9rem;
      margin-top: 4px;
    }

    /* Canvas MER */
    .canvas-wrap {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      padding: 6px;
      min-height: 300px;
      position: relative;
    }

    .canvas-controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 8px;
    }

    .canvas-btn {
      border: 1px solid #d1d5db;
      background: #fff;
      border-radius: 8px;
      padding: 6px 12px;
      cursor: pointer;
    }

    .canvas-btn:hover {
      background: #f0f0f0;
    }

    .canvas-btn.active {
      background: #eef2ff;
      border-color: #6366f1;
    }

    svg.mer-canvas {
      width: 100%;
      height: 320px;
      background: #fefefe;
      border-radius: 8px;
    }

    .entity {
      fill: #e0e7ff;
      stroke: #4f46e5;
      stroke-width: 2;
      cursor: move;
    }

    .relationship {
      fill: #fef3c7;
      stroke: #d97706;
      stroke-width: 2;
      cursor: move;
    }

    .attribute {
      fill: #d1fae5;
      stroke: #059669;
      stroke-width: 2;
      cursor: move;
    }

    .label {
      font-size: 11px;
      fill: #111827;
      pointer-events: none;
    }

    /* Quiz */
    .quiz-item {
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      padding: 10px;
      margin: 8px 0;
      background: #fff;
    }

    .options {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 6px;
    }

    .option-btn {
      border: 1px solid #d1d5db;
      background: #fff;
      border-radius: 10px;
      padding: 6px 12px;
      cursor: pointer;
    }

    .option-btn.correct {
      background: #ecfdf5;
      border-color: #16a34a;
    }

    .option-btn.incorrect {
      background: #fee2e2;
      border-color: #dc2626;
    }

    .feedback {
      margin-top: 6px;
      font-weight: 500;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>2.4 ‚Äî Construindo o MER no brModelo</h1>
    <p class="note">Aprenda a usar ferramentas de modelagem e siga o checklist de boas pr√°ticas.</p>

    <div class="tabs" role="tablist">
      <button class="tab active" data-key="tour" role="tab">Tour brModelo</button>
      <button class="tab" data-key="canvas" role="tab">Mini-Canvas</button>
      <button class="tab" data-key="checklist" role="tab">Checklist</button>
      <button class="tab" data-key="quiz" role="tab">Quiz</button>
    </div>

    <!-- Painel: Tour -->
    <section class="panel active" data-key="tour" aria-label="Tour">
      <div class="grid">
        <div class="box">
          <h3>brModelo Web</h3>
          <p>Ferramenta brasileira para modelagem ER:</p>
          <p><a href="https://brmodeloweb.com/" target="_blank" rel="noopener" style="color:#4f46e5;font-weight:600;">üîó
              brmodeloweb.com</a></p>
          <h4>S√≠mbolos do MER:</h4>
          <ul class="list">
            <li><strong>Ret√¢ngulo:</strong> Entidades</li>
            <li><strong>Losango:</strong> Relacionamentos</li>
            <li><strong>Elipse:</strong> Atributos</li>
            <li><strong>Sublinhado:</strong> Chave Prim√°ria (PK)</li>
          </ul>
        </div>
        <div class="box">
          <h3>Passos B√°sicos</h3>
          <ol class="list">
            <li>Acesse o brModelo Web</li>
            <li>Crie um novo projeto (Conceitual)</li>
            <li>Adicione entidades (ret√¢ngulos)</li>
            <li>Defina atributos (elipses)</li>
            <li>Conecte com relacionamentos (losangos)</li>
            <li>Configure cardinalidades (1:1, 1:N, N:N)</li>
            <li>Exporte como imagem ou PDF</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- Painel: Canvas Interativo -->
    <section class="panel" data-key="canvas" aria-label="Canvas">
      <div class="box">
        <h3>Mini-Constructor MER</h3>
        <p class="note">Clique nos bot√µes e depois clique no canvas para adicionar elementos.</p>
        <div class="canvas-controls">
          <button class="canvas-btn" data-tool="entity">+ Entidade</button>
          <button class="canvas-btn" data-tool="attr">+ Atributo</button>
          <button class="canvas-btn" data-tool="rel">+ Relacionamento</button>
          <button class="canvas-btn" data-tool="clear">Limpar</button>
        </div>
        <div class="canvas-wrap">
          <svg class="mer-canvas" id="mer-canvas"></svg>
        </div>
        <p class="note">Este √© um simulador simplificado. Use brModelo Web para diagramas completos.</p>
      </div>
    </section>

    <!-- Painel: Checklist -->
    <section class="panel" data-key="checklist" aria-label="Checklist">
      <div class="box">
        <h3>Checklist de Modelagem</h3>
        <p class="note">Marque os itens conforme voc√™ valida seu modelo:</p>
        <ul class="checklist" id="checklist">
          <li><input type="checkbox" data-item="1"><span>Entidades nomeadas claramente (substantivos)</span></li>
          <li><input type="checkbox" data-item="2"><span>Atributos definidos para cada entidade</span></li>
          <li><input type="checkbox" data-item="3"><span>Chaves prim√°rias identificadas (sublinhadas)</span></li>
          <li><input type="checkbox" data-item="4"><span>Relacionamentos conectando entidades</span></li>
          <li><input type="checkbox" data-item="5"><span>Cardinalidades definidas (1:1, 1:N, N:N)</span></li>
          <li><input type="checkbox" data-item="6"><span>Participa√ß√£o obrigat√≥ria marcada onde necess√°rio</span></li>
          <li><input type="checkbox" data-item="7"><span>Sem grupos repetidos (colunas autor1, autor2...)</span></li>
          <li><input type="checkbox" data-item="8"><span>Relacionamentos N:N com tabela associativa</span></li>
        </ul>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill" style="width:0%;"></div>
        </div>
        <div class="progress-text" id="progress-text">0 de 8 itens conclu√≠dos</div>
      </div>
    </section>

    <!-- Painel: Quiz -->
    <section class="panel" data-key="quiz" aria-label="Quiz">
      <div class="box">
        <h3>Teste seus Conhecimentos</h3>

        <div class="quiz-item" id="q1">
          <p><strong>1.</strong> No brModelo, qual forma representa relacionamentos?</p>
          <div class="options">
            <button class="option-btn" data-i="0">Ret√¢ngulo</button>
            <button class="option-btn" data-i="1">Losango</button>
            <button class="option-btn" data-i="2">Elipse</button>
          </div>
          <div class="feedback"></div>
        </div>

        <div class="quiz-item" id="q2">
          <p><strong>2.</strong> Para indicar que um atributo √© chave prim√°ria, usa-se:</p>
          <div class="options">
            <button class="option-btn" data-i="0">Sublinhado</button>
            <button class="option-btn" data-i="1">Negrito</button>
            <button class="option-btn" data-i="2">Cor vermelha</button>
          </div>
          <div class="feedback"></div>
        </div>

        <div class="quiz-item" id="q3">
          <p><strong>3.</strong> Participa√ß√£o obrigat√≥ria significa:</p>
          <div class="options">
            <button class="option-btn" data-i="0">Cardinalidade m√°xima = 1</button>
            <button class="option-btn" data-i="1">A entidade deve participar (m√≠nimo = 1)</button>
            <button class="option-btn" data-i="2">Uso de chave estrangeira</button>
          </div>
          <div class="feedback"></div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // Tabs
    document.querySelector('.tabs').addEventListener('click', (ev) => {
      const btn = ev.target.closest('.tab'); if (!btn) return;
      const key = btn.getAttribute('data-key');
      document.querySelectorAll('.tab').forEach(b => b.classList.toggle('active', b === btn));
      document.querySelectorAll('.panel').forEach(p => p.classList.toggle('active', p.getAttribute('data-key') === key));
    });

    // Canvas MER
    const svg = document.getElementById('mer-canvas');
    let currentTool = null;
    let elementCount = 0;

    document.querySelectorAll('.canvas-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const tool = btn.dataset.tool;
        if (tool === 'clear') {
          svg.innerHTML = '';
          elementCount = 0;
          return;
        }
        document.querySelectorAll('.canvas-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentTool = tool;
      });
    });

    svg.addEventListener('click', (e) => {
      if (!currentTool) return;
      const rect = svg.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const name = prompt(currentTool === 'entity' ? 'Nome da entidade:' : currentTool === 'attr' ? 'Nome do atributo:' : 'Nome do relacionamento:');
      if (!name) return;
      elementCount++;

      if (currentTool === 'entity') {
        const r = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
        r.setAttribute('class', 'entity');
        r.setAttribute('x', x - 50);
        r.setAttribute('y', y - 25);
        r.setAttribute('width', 100);
        r.setAttribute('height', 50);
        r.setAttribute('rx', 6);
        svg.appendChild(r);
        const t = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        t.setAttribute('class', 'label');
        t.setAttribute('x', x);
        t.setAttribute('y', y + 4);
        t.setAttribute('text-anchor', 'middle');
        t.textContent = name;
        svg.appendChild(t);
      } else if (currentTool === 'attr') {
        const e2 = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
        e2.setAttribute('class', 'attribute');
        e2.setAttribute('cx', x);
        e2.setAttribute('cy', y);
        e2.setAttribute('rx', 45);
        e2.setAttribute('ry', 20);
        svg.appendChild(e2);
        const t = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        t.setAttribute('class', 'label');
        t.setAttribute('x', x);
        t.setAttribute('y', y + 4);
        t.setAttribute('text-anchor', 'middle');
        t.textContent = name;
        svg.appendChild(t);
      } else if (currentTool === 'rel') {
        const p = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
        p.setAttribute('class', 'relationship');
        p.setAttribute('points', `${x},${y - 25} ${x + 35},${y} ${x},${y + 25} ${x - 35},${y}`);
        svg.appendChild(p);
        const t = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        t.setAttribute('class', 'label');
        t.setAttribute('x', x);
        t.setAttribute('y', y + 4);
        t.setAttribute('text-anchor', 'middle');
        t.textContent = name;
        svg.appendChild(t);
      }
    });

    // Checklist
    const checklist = document.getElementById('checklist');
    const progressFill = document.getElementById('progress-fill');
    const progressText = document.getElementById('progress-text');
    const total = checklist.querySelectorAll('input[type="checkbox"]').length;

    function updateProgress() {
      const checked = checklist.querySelectorAll('input:checked').length;
      const pct = Math.round((checked / total) * 100);
      progressFill.style.width = pct + '%';
      progressText.textContent = `${checked} de ${total} itens conclu√≠dos`;
      checklist.querySelectorAll('li').forEach(li => {
        const cb = li.querySelector('input');
        li.querySelector('span').classList.toggle('done', cb.checked);
      });
    }

    checklist.addEventListener('change', updateProgress);

    // Quiz
    const answers = { q1: 1, q2: 0, q3: 1 };
    const explanations = {
      q1: 'Losangos representam relacionamentos no MER.',
      q2: 'Chave prim√°ria √© indicada por sublinhado.',
      q3: 'Participa√ß√£o obrigat√≥ria: m√≠nimo = 1 (a entidade deve participar).'
    };

    document.querySelectorAll('.quiz-item').forEach(item => {
      const id = item.id;
      const fb = item.querySelector('.feedback');
      item.querySelectorAll('.option-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const chosen = Number(btn.dataset.i);
          const correct = answers[id];
          item.querySelectorAll('.option-btn').forEach(b => b.classList.remove('correct', 'incorrect'));
          btn.classList.add(chosen === correct ? 'correct' : 'incorrect');
          fb.textContent = chosen === correct ? `Correto! ‚úÖ ${explanations[id]}` : `Incorreto. ${explanations[id]}`;
          fb.style.color = chosen === correct ? '#16a34a' : '#dc2626';
        });
      });
    });
  </script>
</body>

</html>