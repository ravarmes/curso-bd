<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Práticas 5.1 — JOINs e Relacionamentos</title>
    <style>
        :root {
            --bg: #f6f8fb;
            --surface: #fff;
            --border: #dde2eb;
            --text: #1f2937;
            --muted: #6b7280;
            --good: #16a34a;
            --bad: #dc2626;
            --accent: #2563eb;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
            color: var(--text);
            background: var(--bg);
        }

        main {
            padding: 16px;
            max-width: 1000px;
            margin: 0 auto;
        }

        h2 {
            margin: 0 0 10px;
            font-size: 1.2rem;
        }

        .tabs {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .tab {
            border: 1px solid var(--border);
            background: var(--surface);
            border-radius: 10px;
            padding: 8px 14px;
            cursor: pointer;
        }

        .tab.active {
            background: #eef2ff;
            border-color: #6366f1;
        }

        .panel {
            display: none;
        }

        .panel.active {
            display: block;
        }

        .box {
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 14px;
            background: var(--surface);
            margin: 10px 0;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .note {
            color: var(--muted);
            font-size: 0.92rem;
        }

        .btn {
            border: 1px solid var(--border);
            background: var(--surface);
            border-radius: 10px;
            padding: 8px 14px;
            cursor: pointer;
            margin: 4px 0;
        }

        .btn:hover {
            background: #eef2ff;
        }

        .feedback {
            margin-top: 10px;
            font-weight: 600;
        }

        .feedback.ok {
            color: var(--good);
        }

        .feedback.err {
            color: var(--bad);
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 12px;
            border-radius: 10px;
            overflow-x: auto;
            font-size: 0.85rem;
        }

        .kw {
            color: #93c5fd;
        }

        .id {
            color: #fda4af;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        th,
        td {
            border: 1px solid var(--border);
            padding: 6px 8px;
            text-align: left;
        }

        th {
            background: #f1f5f9;
        }

        .highlight {
            background: #fef3c7;
        }

        .null {
            color: #9ca3af;
            font-style: italic;
        }

        .venn {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 16px 0;
        }

        .venn-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            opacity: 0.8;
        }

        .venn-a {
            background: #dbeafe;
            margin-right: -30px;
        }

        .venn-b {
            background: #fef3c7;
            margin-left: -30px;
        }

        .venn-inter {
            position: relative;
            z-index: 1;
        }
    </style>
</head>

<body>
    <main>
        <h2>Práticas 5.1 — Junções (JOINs) e Relacionamentos</h2>

        <div class="tabs">
            <button class="tab active" data-key="visual">Visualização</button>
            <button class="tab" data-key="inner">INNER JOIN</button>
            <button class="tab" data-key="left">LEFT JOIN</button>
            <button class="tab" data-key="anti">Anti-Join</button>
        </div>

        <!-- Visual -->
        <section class="panel active" data-key="visual">
            <div class="box">
                <h3>Tipos de JOIN - Diagrama de Venn</h3>
                <div class="grid">
                    <div>
                        <h4>INNER JOIN</h4>
                        <div class="venn">
                            <div class="venn-circle venn-a">A</div>
                            <div class="venn-circle venn-b venn-inter"
                                style="background:linear-gradient(90deg, #93c5fd 50%, #fde68a 50%);">∩</div>
                        </div>
                        <p class="note">Retorna apenas registros com correspondência em AMBAS as tabelas.</p>
                    </div>
                    <div>
                        <h4>LEFT JOIN</h4>
                        <div class="venn">
                            <div class="venn-circle venn-a" style="background:#3b82f6;color:#fff;">A</div>
                            <div class="venn-circle venn-b venn-inter">B</div>
                        </div>
                        <p class="note">Retorna TODOS de A, mesmo sem correspondência em B (NULL).</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- INNER JOIN -->
        <section class="panel" data-key="inner">
            <div class="box">
                <h3>Simulador INNER JOIN</h3>
                <div class="grid">
                    <div>
                        <h4>Tabela: aluno</h4>
                        <table id="tbl-aluno-inner">
                            <thead>
                                <tr>
                                    <th>id</th>
                                    <th>nome</th>
                                    <th>turma_id</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        <h4>Tabela: turma</h4>
                        <table id="tbl-turma-inner">
                            <thead>
                                <tr>
                                    <th>id</th>
                                    <th>nome</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div>
                        <h4>Query:</h4>
                        <pre><span class="kw">SELECT</span> a.<span class="id">nome</span>, t.<span class="id">nome</span>
<span class="kw">FROM</span> <span class="id">aluno</span> a
<span class="kw">INNER JOIN</span> <span class="id">turma</span> t
  <span class="kw">ON</span> a.<span class="id">turma_id</span> = t.<span class="id">id</span>;</pre>
                        <button class="btn" id="exec-inner">Executar INNER JOIN</button>
                        <h4>Resultado:</h4>
                        <table id="result-inner">
                            <thead>
                                <tr>
                                    <th>aluno.nome</th>
                                    <th>turma.nome</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- LEFT JOIN -->
        <section class="panel" data-key="left">
            <div class="box">
                <h3>Simulador LEFT JOIN</h3>
                <div class="grid">
                    <div>
                        <h4>Tabela: aluno</h4>
                        <table id="tbl-aluno-left">
                            <thead>
                                <tr>
                                    <th>id</th>
                                    <th>nome</th>
                                    <th>turma_id</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        <h4>Tabela: turma</h4>
                        <table id="tbl-turma-left">
                            <thead>
                                <tr>
                                    <th>id</th>
                                    <th>nome</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div>
                        <h4>Query:</h4>
                        <pre><span class="kw">SELECT</span> a.<span class="id">nome</span>, t.<span class="id">nome</span>
<span class="kw">FROM</span> <span class="id">aluno</span> a
<span class="kw">LEFT JOIN</span> <span class="id">turma</span> t
  <span class="kw">ON</span> a.<span class="id">turma_id</span> = t.<span class="id">id</span>;</pre>
                        <button class="btn" id="exec-left">Executar LEFT JOIN</button>
                        <h4>Resultado:</h4>
                        <table id="result-left">
                            <thead>
                                <tr>
                                    <th>aluno.nome</th>
                                    <th>turma.nome</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        <p class="note">Note os valores NULL para alunos sem turma correspondente.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Anti-Join -->
        <section class="panel" data-key="anti">
            <div class="box">
                <h3>Anti-Join (Registros SEM correspondência)</h3>
                <div class="grid">
                    <div>
                        <h4>Tabelas de exemplo:</h4>
                        <table id="tbl-aluno-anti">
                            <thead>
                                <tr>
                                    <th>id</th>
                                    <th>nome</th>
                                    <th>turma_id</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div>
                        <h4>Query Anti-Join:</h4>
                        <pre><span class="kw">SELECT</span> a.<span class="id">nome</span>
<span class="kw">FROM</span> <span class="id">aluno</span> a
<span class="kw">LEFT JOIN</span> <span class="id">turma</span> t
  <span class="kw">ON</span> a.<span class="id">turma_id</span> = t.<span class="id">id</span>
<span class="kw">WHERE</span> t.<span class="id">id</span> <span class="kw">IS NULL</span>;</pre>
                        <button class="btn" id="exec-anti">Executar Anti-Join</button>
                        <h4>Resultado:</h4>
                        <table id="result-anti">
                            <thead>
                                <tr>
                                    <th>aluno.nome (sem turma)</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        <p class="note">Retorna apenas alunos que NÃO têm turma correspondente.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Tabs
        document.querySelector('.tabs').addEventListener('click', e => {
            const btn = e.target.closest('.tab'); if (!btn) return;
            document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t === btn));
            document.querySelectorAll('.panel').forEach(p => p.classList.toggle('active', p.dataset.key === btn.dataset.key));
        });

        // Data
        const alunos = [
            { id: 1, nome: 'Ana', turma_id: 1 },
            { id: 2, nome: 'Bruno', turma_id: 2 },
            { id: 3, nome: 'Carlos', turma_id: 1 },
            { id: 4, nome: 'Diana', turma_id: null },
            { id: 5, nome: 'Eduardo', turma_id: 99 }
        ];
        const turmas = [
            { id: 1, nome: 'Banco de Dados' },
            { id: 2, nome: 'Algoritmos' }
        ];

        function renderAlunos(tbodyId) {
            document.querySelector(`#${tbodyId} tbody`).innerHTML = alunos.map(a =>
                `<tr><td>${a.id}</td><td>${a.nome}</td><td>${a.turma_id ?? '<span class="null">NULL</span>'}</td></tr>`
            ).join('');
        }

        function renderTurmas(tbodyId) {
            document.querySelector(`#${tbodyId} tbody`).innerHTML = turmas.map(t =>
                `<tr><td>${t.id}</td><td>${t.nome}</td></tr>`
            ).join('');
        }

        // Init tables
        ['tbl-aluno-inner', 'tbl-aluno-left', 'tbl-aluno-anti'].forEach(renderAlunos);
        ['tbl-turma-inner', 'tbl-turma-left'].forEach(renderTurmas);

        // INNER JOIN
        document.getElementById('exec-inner').addEventListener('click', () => {
            const result = alunos
                .map(a => ({ aluno: a.nome, turma: turmas.find(t => t.id === a.turma_id)?.nome }))
                .filter(r => r.turma);
            document.querySelector('#result-inner tbody').innerHTML = result.map(r =>
                `<tr class="highlight"><td>${r.aluno}</td><td>${r.turma}</td></tr>`
            ).join('');
        });

        // LEFT JOIN
        document.getElementById('exec-left').addEventListener('click', () => {
            const result = alunos.map(a => ({
                aluno: a.nome,
                turma: turmas.find(t => t.id === a.turma_id)?.nome ?? null
            }));
            document.querySelector('#result-left tbody').innerHTML = result.map(r =>
                `<tr class="${r.turma ? 'highlight' : ''}"><td>${r.aluno}</td><td>${r.turma ?? '<span class="null">NULL</span>'}</td></tr>`
            ).join('');
        });

        // Anti-Join
        document.getElementById('exec-anti').addEventListener('click', () => {
            const result = alunos.filter(a => !turmas.find(t => t.id === a.turma_id));
            document.querySelector('#result-anti tbody').innerHTML = result.map(r =>
                `<tr class="highlight"><td>${r.nome}</td></tr>`
            ).join('');
        });
    </script>
</body>

</html>